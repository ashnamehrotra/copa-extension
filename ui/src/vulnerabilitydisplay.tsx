import React from 'react';
import { Box, Typography, Stack, Tooltip, LinearProgress } from '@mui/material';

const VULN_UNLOADED = 0;
const VULN_LOADING = 1;
const VULN_LOADED = 2;

export function VulnerabilityDisplay(props: any) {

  function VulnerabilityBox(props: any) {

    const boxWidth = 2;
    const boxHeight = 0.20;

    const getRadius = (roundedSide: string) => {
      if (roundedSide === "left") {
        return '3px 0px 0px 3px';
      } else if (roundedSide === "right") {
        return '0px 3px 3px 0px';
      } else {
        return '0px 0px 0px 0px'
      }
    }

    return (
      <Tooltip title={props.tooltip}>
        <Box
          sx={{
            backgroundColor: props.color,
            color: props.renderWhiteText ? '#fff' : '#000',
            paddingLeft: boxWidth,
            paddingRight: boxWidth,
            paddingTop: boxHeight,
            paddingBottom: boxHeight,
            borderRadius: getRadius(props.roundedSide)
          }}
        >
          {props.value}
        </Box>
      </Tooltip>
    )
  }

  const unloadedPage = <Box><Typography>Nothing analyzed</Typography></Box>
  const loadingPage = <LinearProgress />

  const loadedPage = <Stack direction='row' borderRadius={20}>
    <VulnerabilityBox
      color='#FFFFFF'
      value={props.vulnerabilityCount["CRITICAL"]}
      tooltip="Critical"
      roundedSide='left'
    />
    <VulnerabilityBox
      color='#D52536'
      value={props.vulnerabilityCount["HIGH"]}
      renderWhiteText={true}
      tooltip="High"
    />
    <VulnerabilityBox
      color='#FBB552'
      value={props.vulnerabilityCount["MEDIUM"]}
      tooltip="Medium"
    />
    <VulnerabilityBox
      color='#FCE1A9'
      value={props.vulnerabilityCount["LOW"]}
      tooltip="Low"
    />
    <VulnerabilityBox
      color='#C4C8D1'
      value={props.vulnerabilityCount["UNKNOWN"]}
      tooltip="Unknown"
      roundedSide='right'
    />
  </Stack >


  return (
    <Box>
      {(props.vulnState === VULN_UNLOADED) && unloadedPage}
      {(props.vulnState === VULN_LOADING) && loadingPage}
      {(props.vulnState === VULN_LOADED) && loadedPage}
    </Box>
  );
}

